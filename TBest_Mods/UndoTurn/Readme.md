Requiers some changes to the mod framework before this can be fully done. But I put up the WIP code anyway.
